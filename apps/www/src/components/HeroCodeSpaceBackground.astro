---
import { ENABLE_INDEX_BG_ANIMATION } from "@lib/constant";
import { SHOW_LOWER_BG_ANIMATION } from "@lib/constant";
import { SHOW_BOTTOM_BG_ANIMATION } from "@lib/constant";
---

<div
  class="hero-code-space-bg"
  aria-hidden="true"
  data-bg-animated={ENABLE_INDEX_BG_ANIMATION ? "true" : "false"}
  data-show-lower-bg-animation={SHOW_LOWER_BG_ANIMATION ? "true" : "false"}
  data-show-elements={SHOW_BOTTOM_BG_ANIMATION ? "true" : "false"}
>
  {
    SHOW_BOTTOM_BG_ANIMATION && (
      <>
        <div class="hero-code-space-tunnel"></div>
        <div class="hero-code-space-scene">
          <div class="hero-code-space-world" data-hero-code-space-world></div>
        </div>
      </>
    )
  }
</div>

<script>
  const PANEL_DATA = [
    // left side
    [-60, -70, -300, 60, 0, 0.88, "red", 4],
    [-60, -42, -300, 60, 0, 0.88, "blue", 0],
    [-60, -8, -300, 60, 0, 0.88, "yellow", 3],
    [-60, 38, -300, 60, 0, 0.88, "green", 2],
    [-60, 68, -300, 60, 0, 0.88, "pink", 1],

    [-63, -68, -450, 60, 0, 0.82, "yellow", 3],

    [-63, 5, -450, 60, 0, 0.82, "pink", 1],
    [-63, 55, -450, 60, 0, 0.82, "blue", 2],

    [-65, -72, -600, 60, 0, 0.74, "green", 3],
    [-65, -30, -600, 60, 0, 0.74, "pink", 4],
    [-65, 22, -600, 60, 0, 0.74, "yellow", 1],
    [-65, 62, -600, 60, 0, 0.74, "red", 0],

    [-68, -68, -750, 60, 0, 0.66, "blue", 2],
    [-68, -30, -750, 60, 0, 0.66, "green", 1],
    [-68, 15, -750, 60, 0, 0.66, "red", 4],
    [-68, 52, -750, 60, 0, 0.66, "yellow", 0],

    [-70, -70, -900, 60, 0, 0.58, "yellow", 1],
    [-70, -30, -900, 60, 0, 0.58, "green", 0],
    [-70, 30, -900, 60, 0, 0.58, "blue", 2],
    [-70, 62, -900, 60, 0, 0.58, "pink", 3],

    [-74, -68, -1200, 60, 0, 0.44, "pink", 3],
    [-74, -25, -1200, 60, 0, 0.44, "red", 4],
    [-74, 25, -1200, 60, 0, 0.44, "yellow", 1],
    [-74, 65, -1200, 60, 0, 0.44, "green", 2],

    [-78, -62, -1600, 60, 0, 0.3, "blue", 0],
    [-78, -20, -1600, 60, 0, 0.3, "pink", 3],
    [-78, 32, -1600, 60, 0, 0.3, "green", 1],
    [-78, 62, -1600, 60, 0, 0.3, "yellow", 4],

    [-82, -55, -2100, 60, 0, 0.16, "red", 2],
    [-82, -8, -2100, 60, 0, 0.16, "pink", 1],
    [-82, 18, -2100, 60, 0, 0.16, "blue", 0],
    [-82, 40, -2100, 60, 0, 0.16, "yellow", 3],

    [60, -42, -300, -60, 0, 0.88, "yellow", 1],
    [60, -8, -300, -60, 0, 0.88, "blue", 0],
    [60, 38, -300, -60, 0, 0.88, "red", 3],
    [60, 68, -300, -60, 0, 0.88, "pink", 2],


    // right side
    [63, -34, -450, -60, 0, 0.82, "pink", 4],
    [63, 5, -450, -60, 0, 0.82, "red", 0],
    [63, 55, -450, -60, 0, 0.82, "yellow", 2],

    [65, -72, -600, -60, 0, 0.74, "pink", 3],

    [65, 22, -600, -60, 0, 0.74, "green", 1],

    [68, -30, -750, -60, 0, 0.66, "red", 3],
    [68, 52, -750, -60, 0, 0.66, "green", 0],

    [70, -70, -900, -60, 0, 0.58, "red", 1],
    [70, -30, -900, -60, 0, 0.58, "yellow", 0],
    [70, 30, -900, -60, 0, 0.58, "pink", 3],
    [70, 62, -900, -60, 0, 0.58, "blue", 2],

    [74, -68, -1200, -60, 0, 0.44, "green", 3],
    [74, -25, -1200, -60, 0, 0.44, "blue", 4],
    [74, 25, -1200, -60, 0, 0.44, "red", 1],
    [74, 65, -1200, -60, 0, 0.44, "pink", 2],

    [78, -62, -1600, -60, 0, 0.3, "yellow", 0],
    [78, -20, -1600, -60, 0, 0.3, "green", 3],
    [78, 32, -1600, -60, 0, 0.3, "blue", 1],
    [78, 62, -1600, -60, 0, 0.3, "red", 4],

    [82, -55, -2100, -60, 0, 0.16, "pink", 2],
    [82, -8, -2100, -60, 0, 0.16, "yellow", 1],
    [82, 18, -2100, -60, 0, 0.16, "red", 3],
    [82, 40, -2100, -60, 0, 0.16, "blue", 0],
    [82, 24, -2100, -60, 0, 0.16, "green", 4],
  ];

  const CODE_SNIPPETS = [
    `<span class="hero-code-space-cm">// Core initializer</span>
<span class="hero-code-space-kw">const</span> <span class="hero-code-space-fn">init</span> <span class="hero-code-space-op">=</span> () <span class="hero-code-space-op">=></span> {
  <span class="hero-code-space-fn">console</span>.log(<span class="hero-code-space-st">"Systems Online"</span>);
  <span class="hero-code-space-fn">loadModules</span>();
  <span class="hero-code-space-kw">return</span> <span class="hero-code-space-fn">Promise</span>.resolve();
}`,
    `<span class="hero-code-space-fn">.panel-glow</span> {
  background<span class="hero-code-space-op">:</span> <span class="hero-code-space-fn">rgba</span>(<span class="hero-code-space-num">5</span>, <span class="hero-code-space-num">10</span>, <span class="hero-code-space-num">25</span>, .<span class="hero-code-space-num">7</span>);
  border<span class="hero-code-space-op">:</span> <span class="hero-code-space-num">1px</span> solid <span class="hero-code-space-st">#00f3ff40</span>;
  box-shadow<span class="hero-code-space-op">:</span> <span class="hero-code-space-num">0</span> <span class="hero-code-space-num">0</span> <span class="hero-code-space-num">20px</span>
    <span class="hero-code-space-st">#00f3ff20</span>;
  border-radius<span class="hero-code-space-op">:</span> <span class="hero-code-space-num">8px</span>;
}`,
    `<span class="hero-code-space-kw">function</span> <span class="hero-code-space-fn">renderLoop</span>(time) {
  <span class="hero-code-space-fn">requestAnimationFrame</span>(
    <span class="hero-code-space-fn">renderLoop</span>
  );
  <span class="hero-code-space-fn">updatePhysics</span>(time);
  <span class="hero-code-space-fn">drawScene</span>();
}`,
    `<span class="hero-code-space-kw">export default class</span> <span class="hero-code-space-fn">NeuralNet</span> {
  <span class="hero-code-space-fn">constructor</span>() {
    <span class="hero-code-space-kw">this</span>.layers <span class="hero-code-space-op">=</span> [];
    <span class="hero-code-space-kw">this</span>.lr <span class="hero-code-space-op">=</span> <span class="hero-code-space-num">0.001</span>;
  }
  <span class="hero-code-space-fn">forward</span>(x) {
    <span class="hero-code-space-kw">return this</span>.layers
      .<span class="hero-code-space-fn">reduce</span>((a, l) <span class="hero-code-space-op">=></span> l.<span class="hero-code-space-fn">pass</span>(a), x);
  }
}`,
    `<span class="hero-code-space-kw">SELECT</span> u.name,
  <span class="hero-code-space-fn">COUNT</span>(e.id) <span class="hero-code-space-kw">AS</span> events,
  <span class="hero-code-space-fn">MAX</span>(e.score) <span class="hero-code-space-kw">AS</span> peak
<span class="hero-code-space-kw">FROM</span> users u
<span class="hero-code-space-kw">JOIN</span> events e
  <span class="hero-code-space-kw">ON</span> u.id <span class="hero-code-space-op">=</span> e.user_id
<span class="hero-code-space-kw">GROUP BY</span> u.name
<span class="hero-code-space-kw">ORDER BY</span> peak <span class="hero-code-space-kw">DESC</span>;`,
  ];

  const LANGUAGES = ["JS", "CSS", "JS", "TS", "SQL"];
  const LEFT_PANEL_SHIFT_VW = 7;
  const MOBILE_IPAD_QUERY = "(max-width: 1024px)";
  const MOBILE_QUERY = "(max-width: 768px)";
  const COMPACT_PANEL_LIMIT = 12;
  const COMPACT_SIDE_VISIBLE_PER_SIDE = 3;
  const COMPACT_SIDE_DEPTH_MAX = 600;
  const clamp = (value: number, min: number, max: number) => Math.min(max, Math.max(min, value));

  type PanelEntry = {
    panel: (typeof PANEL_DATA)[number];
    panelIndex: number;
  };

  const getPanelEntriesByDepth = (maxDepth: number): PanelEntry[] =>
    PANEL_DATA.map((panel, panelIndex) => ({ panel, panelIndex })).filter(
      ({ panel: [, , z] }) => Math.abs(z as number) <= maxDepth
    );

  const getCompactPanelEntries = (entries: PanelEntry[]): PanelEntry[] => {
    const pickSidePanels = (isLeftSide: boolean) =>
      entries
        .filter(({ panel: [xvw, , z] }) => {
          const onSide = isLeftSide ? (xvw as number) < 0 : (xvw as number) > 0;
          return onSide && Math.abs(z as number) <= COMPACT_SIDE_DEPTH_MAX;
        })
        .sort((a, b) => Math.abs((a.panel[2] as number)) - Math.abs((b.panel[2] as number)))
        .slice(0, COMPACT_SIDE_VISIBLE_PER_SIDE);

    const leftVisible = pickSidePanels(true);
    const rightVisible = pickSidePanels(false);
    const selected = [...leftVisible, ...rightVisible];
    const selectedIndices = new Set(selected.map(({ panelIndex }) => panelIndex));
    const remainingSlots = Math.max(0, COMPACT_PANEL_LIMIT - selected.length);

    if (remainingSlots === 0) {
      return selected.sort((a, b) => a.panelIndex - b.panelIndex);
    }

    const backPanels = entries
      .filter(({ panelIndex }) => !selectedIndices.has(panelIndex))
      .sort((a, b) => Math.abs((b.panel[2] as number)) - Math.abs((a.panel[2] as number)))
      .slice(0, remainingSlots);

    return [...selected, ...backPanels].sort((a, b) => a.panelIndex - b.panelIndex);
  };

  function initHeroCodeSpaceScroll(root: HTMLElement, reducedMotion: boolean, shouldAnimate: boolean) {
    if (root.dataset.scrollReady === "true") return;
    root.dataset.scrollReady = "true";

    if (!shouldAnimate || reducedMotion) {
      root.style.setProperty("--hero-scroll-y", "0px");
      root.style.setProperty("--hero-scroll-tilt", "0deg");
      root.style.setProperty("--hero-scroll-skew", "0deg");
      root.style.setProperty("--hero-scroll-depth", "0px");
      root.style.setProperty("--hero-panel-shift", "0px");
      root.style.setProperty("--hero-panel-float", "0px");
      root.style.setProperty("--hero-panel-depth", "0px");
      root.style.setProperty("--hero-panel-sway", "0px");
      root.style.setProperty("--hero-grid-shift", "0px");
      return;
    }

    let momentum = 0;
    let display = 0;
    let lastScrollY = window.scrollY;
    let lastInputAt = performance.now();
    let lastFrameAt = performance.now();
    let rafId = 0;

    const applyScrollVars = () => {
      const tilt = clamp(-display * 0.05, -2.2, 2.2);
      const skew = clamp(display * 0.018, -0.9, 0.9);
      const depth = clamp(Math.abs(display) * 0.2, 0, 10);
      const panelShift = display * 1.25;
      const panelFloat = display * 0.75;
      const panelDepth = display * -1.15;
      const panelSway = clamp(display * 0.4, -20, 20);
      const gridShift = display * 0.75;

      root.style.setProperty("--hero-scroll-y", `${display.toFixed(2)}px`);
      root.style.setProperty("--hero-scroll-tilt", `${tilt.toFixed(3)}deg`);
      root.style.setProperty("--hero-scroll-skew", `${skew.toFixed(3)}deg`);
      root.style.setProperty("--hero-scroll-depth", `${depth.toFixed(2)}px`);
      root.style.setProperty("--hero-panel-shift", `${panelShift.toFixed(2)}px`);
      root.style.setProperty("--hero-panel-float", `${panelFloat.toFixed(2)}px`);
      root.style.setProperty("--hero-panel-depth", `${panelDepth.toFixed(2)}px`);
      root.style.setProperty("--hero-panel-sway", `${panelSway.toFixed(2)}px`);
      root.style.setProperty("--hero-grid-shift", `${gridShift.toFixed(2)}px`);
    };

    const getMaxScroll = () =>
      Math.max(0, document.documentElement.scrollHeight - window.innerHeight);

    const registerInput = (delta: number) => {
      const maxScroll = getMaxScroll();
      const scrollY = window.scrollY;
      const atTop = scrollY <= 2;
      const atBottom = maxScroll > 0 && scrollY >= maxScroll - 2;

      if ((atTop && delta < 0) || (atBottom && delta > 0)) return;

      lastInputAt = performance.now();
      momentum = clamp(momentum + delta * 0.02, -46, 46);
    };

    const onWheel = (event: WheelEvent) => {
      registerInput(event.deltaY);
    };

    const onScroll = (_event: Event) => {
      const nextScrollY = window.scrollY;
      const scrollDelta = nextScrollY - lastScrollY;
      lastScrollY = nextScrollY;
      if (scrollDelta === 0) return;
      registerInput(scrollDelta * 0.9);
    };

    const tick = (time: number) => {
      const now = time || performance.now();
      const delta = Math.min(32, now - lastFrameAt || 16.7);
      lastFrameAt = now;
      const frame = delta / 16.7;

      const maxScroll = getMaxScroll();
      const scrollY = window.scrollY;
      const atTop = scrollY <= 2;
      const atBottom = maxScroll > 0 && scrollY >= maxScroll - 2;
      const activelyScrolling = now - lastInputAt < 130;

      if (atTop || atBottom) {
        momentum *= Math.pow(0.62, frame);
      }

      const target = activelyScrolling && !(atTop || atBottom) ? momentum : 0;
      const ease = activelyScrolling ? 0.2 : 0.12;
      const easedStep = 1 - Math.pow(1 - ease, frame);
      display += (target - display) * easedStep;

      momentum *= Math.pow(activelyScrolling ? 0.84 : 0.56, frame);
      display = clamp(display, -58, 58);
      if (Math.abs(display) < 0.025 && Math.abs(momentum) < 0.025) {
        display = 0;
        momentum = 0;
      }

      applyScrollVars();
      rafId = window.requestAnimationFrame(tick);
    };

    window.addEventListener("wheel", onWheel, { passive: true });
    window.addEventListener("scroll", onScroll, { passive: true });
    applyScrollVars();
    rafId = window.requestAnimationFrame(tick);

    const cleanup = () => {
      window.cancelAnimationFrame(rafId);
      window.removeEventListener("wheel", onWheel);
      window.removeEventListener("scroll", onScroll);
    };

    window.addEventListener("pagehide", cleanup, { once: true });
  }

  function initHeroCodeSpaceBackground() {
    const worlds = document.querySelectorAll<HTMLElement>("[data-hero-code-space-world]");
    if (!worlds.length) return;

    const reducedMotion =
      typeof window !== "undefined" &&
      window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    const mobileViewport = window.matchMedia(MOBILE_QUERY).matches;
    const mobileOrTabletViewport = window.matchMedia(MOBILE_IPAD_QUERY).matches;
    const maxDepth = mobileViewport ? 1200 : 2100;
    const baseEntries = getPanelEntriesByDepth(maxDepth);

    worlds.forEach((world) => {
      if (world.dataset.ready === "true") return;
      world.dataset.ready = "true";

      const root = world.closest<HTMLElement>(".hero-code-space-bg");
      const lowerBgAnimationEnabled = root?.dataset.showLowerBgAnimation === "true";
      const useCompactPanels = lowerBgAnimationEnabled && mobileOrTabletViewport;
      const panelsToRender = useCompactPanels ? getCompactPanelEntries(baseEntries) : baseEntries;

      panelsToRender.forEach(({ panel: [xvw, yvh, z, rotY, rotX, opacity, theme, codeIndex], panelIndex }) => {

        const el = document.createElement("div");
        el.className = `hero-code-space-panel hero-code-space-panel-${theme}`;
        el.innerHTML =
          `<span class="hero-code-space-lang">${LANGUAGES[codeIndex as number]}</span>` +
          CODE_SNIPPETS[codeIndex as number];

        const leftSide = (xvw as number) < 0;
        const adjustedX = leftSide ? (xvw as number) + LEFT_PANEL_SHIFT_VW : (xvw as number);
        const panelOpacity = reducedMotion ? Math.min(opacity as number, 0.72) : (opacity as number);
        const sideDirection = leftSide ? -1 : 1;
        const depthRatio = Math.max(0, (Math.abs(z as number) - 300) / 1800);
        const animatedCard = panelIndex % 3 === 0 || depthRatio > 0.55;
        const verticalDrift = (0.3 + ((codeIndex as number) % 4) * 0.14) * sideDirection;
        const cardDriftFactor = animatedCard ? verticalDrift : verticalDrift * 0.28;
        const swayFactor = animatedCard ? (0.2 + (panelIndex % 5) * 0.07) * sideDirection : 0;
        const depthFactor = animatedCard ? 0.3 + depthRatio * 0.8 : 0;

        el.style.transform = `
          translate(-50%, -50%)
          translate(
            calc(${adjustedX}vw + (var(--hero-panel-sway, 0px) * var(--hero-panel-sway-factor, 0))),
            calc(${yvh}vh + (var(--hero-panel-shift, 0px) * var(--hero-panel-factor, 0)) + (var(--hero-panel-float, 0px) * var(--hero-panel-factor, 0)))
          )
          translateZ(calc(${z}px + (var(--hero-panel-depth, 0px) * var(--hero-panel-depth-factor, 0))))
          rotateY(${rotY}deg)
          rotateX(${rotX}deg)
        `;
        el.style.opacity = String(panelOpacity);
        el.style.setProperty("--hero-panel-factor", `${cardDriftFactor.toFixed(2)}`);
        el.style.setProperty("--hero-panel-sway-factor", `${swayFactor.toFixed(2)}`);
        el.style.setProperty("--hero-panel-depth-factor", `${depthFactor.toFixed(2)}`);

        if (leftSide) {
          const blurPx = Math.min(0.6, 0.12 + depthRatio * 0.48);
          el.classList.add("hero-code-space-panel-left");
          el.style.setProperty("--hero-code-space-left-blur", `${blurPx.toFixed(2)}px`);
        }

        world.appendChild(el);
      });

      const shouldAnimate = root?.dataset.bgAnimated !== "false";
      if (root) initHeroCodeSpaceScroll(root, reducedMotion, shouldAnimate);
    });
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initHeroCodeSpaceBackground, { once: true });
  } else {
    initHeroCodeSpaceBackground();
  }
</script>

<style is:global>
  .hero-code-space-bg {
    --hero-scroll-y: 0px;
    --hero-scroll-tilt: 0deg;
    --hero-scroll-skew: 0deg;
    --hero-scroll-depth: 0px;
    --hero-panel-shift: 0px;
    --hero-panel-float: 0px;
    --hero-panel-depth: 0px;
    --hero-panel-sway: 0px;
    --hero-grid-shift: 0px;
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
    background-image:
      radial-gradient(ellipse 84% 64% at 50% 50%, #0d1535 0%, #030614 70%),
      radial-gradient(ellipse 44% 44% at 18% 82%, rgb(0 243 255 / 5%) 0%, transparent 62%),
      radial-gradient(ellipse 44% 44% at 82% 18%, rgb(255 0 255 / 5%) 0%, transparent 62%);
  }

  .hero-code-space-bg::after {
    content: "";
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgb(0 0 0 / 3%) 2px,
      rgb(0 0 0 / 3%) 4px
    );
    pointer-events: none;
  }

  .hero-code-space-scene {
    position: absolute;
    inset: 0;
    perspective: 1400px;
    perspective-origin: 50% 48%;
    z-index: 2;
    transform: translate3d(0, calc(var(--hero-scroll-y) * 0.08), 0);
    will-change: transform;
  }

  .hero-code-space-tunnel {
    position: absolute;
    inset: -20% -50%;
    perspective: 800px;
    transform-style: preserve-3d;
    pointer-events: none;
    z-index: 1;
    transform-origin: 50% 50%;
    transform: translate3d(0, calc(var(--hero-scroll-y) * 0.36), 0)
      rotateX(var(--hero-scroll-tilt))
      skewY(var(--hero-scroll-skew));
    will-change: transform;
  }

  .hero-code-space-tunnel::before,
  .hero-code-space-tunnel::after {
    content: "";
    position: absolute;
    top: -50%;
    width: 100vw;
    height: 200%;
    background-image:
      linear-gradient(rgb(0 242 255 / 40%) 1px, transparent 1px),
      linear-gradient(90deg, rgb(0 242 255 / 40%) 1px, transparent 1px);
    background-size: 60px 40px;
    opacity: 0.52;
  }

  .hero-code-space-tunnel::before {
    left: 0;
    transform-origin: left center;
    transform: rotateY(75deg) translateZ(-400px) translateY(var(--hero-grid-shift));
    mask-image: linear-gradient(to right, black, transparent 80%);
  }

  .hero-code-space-tunnel::after {
    right: 0;
    transform-origin: right center;
    transform: rotateY(-75deg) translateZ(-400px) translateY(calc(var(--hero-grid-shift) * -1));
    background-image:
      linear-gradient(rgb(0 255 102 / 30%) 1px, transparent 1px),
      linear-gradient(90deg, rgb(0 255 102 / 30%) 1px, transparent 1px);
    mask-image: linear-gradient(to left, black, transparent 80%);
  }

  .hero-code-space-world {
    position: absolute;
    inset: 0;
    transform-style: preserve-3d;
    transform: translate3d(0, calc(var(--hero-scroll-y) * 0.14), calc(var(--hero-scroll-depth) * -1));
    will-change: transform;
  }

  .hero-code-space-panel {
    position: absolute;
    left: 50%;
    top: 50%;
    width: clamp(170px, 23vw, 290px);
    transform-style: preserve-3d;
    background: rgb(4 8 22 / 72%);
    backdrop-filter: blur(6px);
    border-radius: 7px;
    padding: 14px 18px;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: clamp(10px, 0.7vw, 11px);
    line-height: 1.65;
    white-space: pre;
    color: #c8d8f0;
    border: 1px solid transparent;
    border-top-width: 3px;
  }

  .hero-code-space-panel-left {
    -webkit-mask-image: linear-gradient(90deg, transparent 0%, rgb(0 0 0 / 78%) 16%, #000 38%, #000 100%);
    mask-image: linear-gradient(90deg, transparent 0%, rgb(0 0 0 / 78%) 16%, #000 38%, #000 100%);
    filter: saturate(1.05) blur(var(--hero-code-space-left-blur, 0.25px));
  }

  .hero-code-space-panel-blue {
    border-color: rgb(0 243 255 / 25%);
    border-top-color: rgb(0 243 255 / 95%);
    box-shadow: 0 0 18px rgb(0 243 255 / 10%), inset 0 0 30px rgb(0 0 0 / 60%);
  }

  .hero-code-space-panel-green {
    border-color: rgb(0 255 102 / 25%);
    border-top-color: rgb(0 255 102 / 95%);
    box-shadow: 0 0 18px rgb(0 255 102 / 10%), inset 0 0 30px rgb(0 0 0 / 60%);
  }

  .hero-code-space-panel-pink {
    border-color: rgb(255 0 255 / 25%);
    border-top-color: rgb(255 0 255 / 95%);
    box-shadow: 0 0 18px rgb(255 0 255 / 10%), inset 0 0 30px rgb(0 0 0 / 60%);
  }

  .hero-code-space-panel-red {
    border-color: rgb(255 34 68 / 25%);
    border-top-color: rgb(255 34 68 / 95%);
    box-shadow: 0 0 18px rgb(255 34 68 / 10%), inset 0 0 30px rgb(0 0 0 / 60%);
  }

  .hero-code-space-panel-yellow {
    border-color: rgb(255 221 0 / 25%);
    border-top-color: rgb(255 221 0 / 95%);
    box-shadow: 0 0 18px rgb(255 221 0 / 10%), inset 0 0 30px rgb(0 0 0 / 60%);
  }

  .hero-code-space-lang {
    display: block;
    font-size: 9px;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgb(255 255 255 / 7%);
    opacity: 0.85;
  }

  .hero-code-space-panel-blue .hero-code-space-lang {
    color: rgb(0 243 255 / 90%);
  }

  .hero-code-space-panel-green .hero-code-space-lang {
    color: rgb(0 255 102 / 90%);
  }

  .hero-code-space-panel-pink .hero-code-space-lang {
    color: rgb(255 0 255 / 90%);
  }

  .hero-code-space-panel-red .hero-code-space-lang {
    color: rgb(255 34 68 / 90%);
  }

  .hero-code-space-panel-yellow .hero-code-space-lang {
    color: rgb(255 221 0 / 90%);
  }

  .hero-code-space-kw {
    color: #ff00ff;
  }

  .hero-code-space-fn {
    color: #00f3ff;
  }

  .hero-code-space-st {
    color: #00ff66;
  }

  .hero-code-space-op {
    color: #8899bb;
  }

  .hero-code-space-cm {
    color: #445566;
    font-style: italic;
  }

  .hero-code-space-num {
    color: #ffaa44;
  }

  @media (max-width: 768px) {
    .hero-code-space-panel {
      width: min(58vw, 220px);
      font-size: 10px;
      line-height: 1.55;
      padding: 11px 13px;
    }
  }

</style>
